<!DOCTYPE html><html>

<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width"/>
    
    <title>etlqna</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic+Coding&amp;display=swap" rel="stylesheet"/> 
    
    <link href="page.css" rel="stylesheet"/><link href="markdown.css" rel="stylesheet"/><link href="nav.css" rel="stylesheet"/>
    
</head>

<body>




    <nav>
<p><a id="settingsopenbutton">&#9728;</a><a href="#top">&#9650;</a><a href="#bottom">&#9660;</a></p><div id="settingsmenubg"><p><div id="settingsmenu"> <a id="settingsclosebutton">&#10006;</a> <a id="changethemebutton">Set Light Theme</a> <a id="loosepaddingbutton">&#8592; &#8594;</a> <a id="tightpaddingbutton">&#8594; &#8592;</a> </div></p></div>
    </nav>


    <article class="markdown">
        <a id="top"></a>
<p>Etl 질의응답 게시판이 불편해서 여기에 정리!</p><p>최신 수정: 202212132342</p><p><div class="toc"><ol type="1"><li><a href="#team-10-tvalid-tlast-신호-타이밍-질문">&#91;Team 10&#93; TVALID, TLAST 신호 타이밍 질문</a></li><li><a href="#team-6-fc-layer-relu-관련-질문">&#91;Team 6&#93; fc layer relu 관련 질문</a></li><li><a href="#team-18-nexys-mig_dram">&#91;Team 18&#93; nexys mig_dram</a></li><li><a href="#team-6-conv-layer의-input-형식-문의">&#91;Team 6&#93; conv layer의 input 형식 문의</a></li><li><a href="#team-28-ddr2-ddr3-관련-back-compatibility-이슈">&#91;TEAM 28&#93; ddr2, ddr3 관련 back compatibility 이슈</a></li><li><a href="#공지-fpga-layer-test-유의점-updated-1210">&#91;공지&#93; FPGA layer test 유의점 (updated: 12/10)</a></li><li><a href="#team-2-apb-모듈의-paddr-관련-질문입니다">&#91;Team 2&#93; APB 모듈의 PADDR 관련 질문입니다.</a></li><li><a href="#team-25-tb-simulation-멈춤-현상-관련">&#91;Team 25&#93; tb simulation 멈춤 현상 관련</a></li><li><a href="#team-2-git의-vivado-auxiliary-파일-ignore-관련-문의드립니다">&#91;Team 2&#93; Git의 Vivado auxiliary 파일 ignore 관련 문의드립니다.</a></li><li><a href="#team-12-conv-layer-input-size-관련">&#91;team 12&#93; conv layer input size 관련</a></li><li><a href="#verilog-문법-관련-질문">verilog 문법 관련 질문</a></li><li><a href="#team-30-data-receive-질문">&#91;Team 30&#93; data receive 질문</a></li><li><a href="#team-31-board-세팅-관련-문의드립니다">&#91;team 31&#93; board 세팅 관련 문의드립니다.</a></li><li><a href="#team-14-init_calib_done">&#91;Team 14&#93; init_calib_done</a></li><li><a href="#team-20-pool-module에서-s_axis_tready-시그널-질문">&#91;team 20&#93; pool module에서 S_AXIS_TREADY 시그널 질문</a></li><li><a href="#team-1-single-layer-test-관련-문의">&#91;Team 1&#93; single layer test 관련 문의</a></li><li><a href="#team-12-fc-layer-음수-처리">&#91;team 12&#93; fc layer 음수 처리</a></li><li><a href="#team-14-pool-보드-테스트-질문">&#91;Team 14&#93; pool 보드 테스트 질문</a></li><li><a href="#team-30-sram-port-관련-질문">&#91;Team 30&#93; sram port 관련 질문</a></li><li><a href="#team-14-hw-test-synthesis-warning-문의">&#91;Team 14&#93; HW test synthesis warning 문의</a></li><li><a href="#vdma-동작-관련-질문">VDMA 동작 관련 질문</a></li><li><a href="#team-31-clk_counter-관련-문의">&#91;team 31&#93; clk_counter 관련 문의</a></li><li><a href="#fpga-clk-frequency-질문">FPGA CLK frequency 질문</a></li><li><a href="#team-30-paddress-관련-문의">&#91;Team 30&#93; paddress 관련 문의</a></li><li><a href="#team-18-pool-layer-input-data-순서">&#91;Team 18&#93; pool layer input data 순서</a></li><li><a href="#team-8-bram-동작에-관해서-질문-있습니다">&#91;TEAM 8&#93; bram 동작에 관해서 질문 있습니다.</a></li><li><a href="#setup-time-violation-관련-질문">setup time violation 관련 질문</a></li><li><a href="#team-30-비바도-sram-버전-문제">&#91;team 30&#93; 비바도 sram 버전 문제</a></li><li><a href="#team-11-tb-ip할당-문제">&#91;team 11&#93; tb ip할당 문제</a></li><li><a href="#team-2-conv-모듈의-conv_start-신호에-대해-질문드립니다">&#91;Team 2&#93; conv 모듈의 conv_start 신호에 대해 질문드립니다.</a></li><li><a href="#team-14-conv-layer에서의-input-저장-문의">&#91;Team 14&#93; conv layer에서의 input 저장 문의</a></li><li><a href="#team-15-tb에서-data-receive-관련-문의">&#91;Team 15&#93; tb에서 data receive 관련 문의</a></li><li><a href="#team-1-layer_tb-메모리-write-관련-문의">&#91;Team 1&#93; layer_tb 메모리 write 관련 문의</a></li><li><a href="#team-15-tb-project-내-sram-문의">&#91;Team 15&#93; tb project 내 sram 문의</a></li><li><a href="#team-6-module-내의-sram-문의">&#91;Team 6&#93; module 내의 SRAM 문의</a></li><li><a href="#team-5-사용하는-8bit-data-format">&#91;Team 5&#93; 사용하는 8bit data format</a></li><li><a href="#team-14-weight-데이터의-순서-문의">&#91;Team 14&#93; weight 데이터의 순서 문의</a></li><li><a href="#team-31-변수-관련-문의">&#91;Team 31&#93; 변수 관련 문의</a></li><li><a href="#team-14-tb-fbw_writedone-관련-질문입니다">&#91;Team 14&#93; TB (F,B,W)_writedone 관련 질문입니다.</a></li><li><a href="#team-14-vivado-version-관련-질문드립니다">&#91;Team 14&#93; Vivado version 관련 질문드립니다.</a></li></ol></div></p><h2 id="team-10-tvalid-tlast-신호-타이밍-질문">[Team 10] TVALID, TLAST 신호 타이밍 질문</h2><p>안녕하세요 조교님, 교수님. 프로젝트 테스트벤치를 돌리려고 하던 중 궁금한 점이 생겨서 질문드립니다. PPT에는 마지막 신호가 들어올 때 TLAST와 TVALID가 동시에 올라가는 걸로 돼 있지만 실제 테스트벤치 상에서는 TVALID가 꺼진 다음에 TLAST가 올라갑니다. 원래 IP의 구현이 자료와 다르게 돼 있는 건가요?</p><p>감사합니다!</p><hr/><p>(친구답변) 확대해보면 한 사이클 겹친다</p><h2 id="team-6-fc-layer-relu-관련-질문">[Team 6] fc layer relu 관련 질문</h2><p>안녕하세요 조교님, github에 업데이트된 공지에 &quot;You don&apos;t have to implement relu at FC3 layer&quot;라는 공지를 확인하고 질문드립니다. 저는 모든 output에 대해 relu가 되도록 구현했는데, FC3 layer에서는 relu가 되면 안되는건가요? 그러면 relu를 하는 경우와 안하는 경우를 따로 구현해야 하는게 맞는건가요? 그냥 모든 output이 relu되게 구현 후 FC3 layer에서도 relu된 output이 나오도록 하는 것이 잘못된 방법인지 모르겠어서 질문드립니다. 감사합니다.</p><hr/><p>case를 구분하여 구현하셔야 합니다. 그렇지 않으면 single layer test의 마지막 FC3에서 wrong result가 나올 겁니다.</p><h2 id="team-18-nexys-mig_dram">[Team 18] nexys mig_dram</h2><p>안녕하세요 이전 공지대로 mig.prj만 바꿔주고 single layer test를 진행했을 때, 결과가 제대로 나와서 문제가 없는 줄 알았는데, 혹시 12/10 바뀐 공지대로 다시 바꿔줘야 하는지 궁금합니다.</p><hr/><p>변경한 mig.prj로 synthesis, implementation을 수행하면 문제가 없을 것입니다. 바뀐 공지는 이미 implementation을 수행해 xci 파일이 생성된 경우에 대해 문제가 있어 수정 공지를 드린 것입니다.</p><p>즉, 문제가 없고 implementation에서 특이사항이 없다면 안바꾸셔도 됩니다.</p><h2 id="team-6-conv-layer의-input-형식-문의">[Team 6] conv layer의 input 형식 문의</h2><p>안녕하세요. 조금 헷갈리는 점이 있어 문의드립니다.</p><p>conv 모듈에 들어오는 input이 구체적으로 어떤 sequence로 들어오는 건지 여쭤보고 싶습니다. 예를 들어 filter가</p><pre class="fenced-code-block"><code><span class="code-fence-row"><span class="code-fence-code">a11 a12 a13   b11 b12 b13   c11 c12 c13</span></span>
<span class="code-fence-row"><span class="code-fence-code"></span></span>
<span class="code-fence-row"><span class="code-fence-code">a21 a22 a23   b21 b22 b23   c21 c22 c23</span></span>
<span class="code-fence-row"><span class="code-fence-code"></span></span>
<span class="code-fence-row"><span class="code-fence-code">a31 a32 a33   b31 b32 b33   c31 c32 c33</span></span>
<span class="code-fence-row"><span class="code-fence-code"></span></span>
<span class="code-fence-row"><span class="code-fence-code">d11 d12 d13   e11 e12 e13   f11 f12 f13</span></span>
<span class="code-fence-row"><span class="code-fence-code"></span></span>
<span class="code-fence-row"><span class="code-fence-code">d21 d22 d23   e21 e22 e23   f21 f22 f23</span></span>
<span class="code-fence-row"><span class="code-fence-code"></span></span>
<span class="code-fence-row"><span class="code-fence-code">d31 d32 d33   e31 e32 e33   f31 f32 f33</span></span>
</code></pre><p>해서 channel = 3인 filter가 2개라면 들어오는 data의 sequence는</p><pre class="fenced-code-block"><code><span class="code-fence-row"><span class="code-fence-code">a11 a12 a13 a21      (맨 왼쪽이 MSB)</span></span>
<span class="code-fence-row"><span class="code-fence-code"></span></span>
<span class="code-fence-row"><span class="code-fence-code">a22 a23 a31 a32</span></span>
<span class="code-fence-row"><span class="code-fence-code"></span></span>
<span class="code-fence-row"><span class="code-fence-code">a33 b11 b12 b13</span></span>
<span class="code-fence-row"><span class="code-fence-code"></span></span>
<span class="code-fence-row"><span class="code-fence-code">...</span></span>
<span class="code-fence-row"><span class="code-fence-code"></span></span>
<span class="code-fence-row"><span class="code-fence-code">c31 c32 c33 d11</span></span>
<span class="code-fence-row"><span class="code-fence-code"></span></span>
<span class="code-fence-row"><span class="code-fence-code">d12 d13 d21 d23</span></span>
<span class="code-fence-row"><span class="code-fence-code"></span></span>
<span class="code-fence-row"><span class="code-fence-code">...</span></span>
</code></pre><p>인가요?</p><p>그리고 이 순서가 input feature에도 똑같이 적용되는지 궁금합니다.</p><p>감사합니다.</p><hr/><p>네 맞습니다. 모든 input data format은 row - col - channel 순서로 들어온다고 생각하시면 됩니다.</p><h2 id="team-28-ddr2-ddr3-관련-back-compatibility-이슈">[TEAM 28] ddr2, ddr3 관련 back compatibility 이슈</h2><p>(질문/답변은 복붙하기 귀찮아서 생략함)</p><p>Nexys 보드만 해당되는 문제인 거 같음. <a href="https://github.com/SNU-Comparch-Classes/ECE-315.A_2022_Fall_Final_Project">https://github.com/SNU-Comparch-Classes/ECE-315.A_2022_Fall_Final_Project</a>에 공지 자주 올라오니까 참고하면 좋을 듯!</p><h2 id="공지-fpga-layer-test-유의점-updated-1210">[공지] FPGA layer test 유의점 (updated: 12/10)</h2><p>안녕하세요 조교입니다. 많은 분들께서 tb를 통과하시고 board의 layer test를 진행하고 계신 것 같습니다. 이와 관련해 몇가지 유의점을 안내드리고자 합니다.</p><ol type="1"><li>GitHub의 공지용 repo를 체크하시고 질문글을 올려주세요. 프로젝트에서 고쳐야 할 부분을 올려두었습니다.</li><li>IP가 lock되어 있는 경우 IP upgrade를 진행하시면 됩니다.</li><li>AXI protocol을 어떠한 가정도 없이 robust하게 구현하시기 바랍니다. Testbench에서는 VDMA로부터의 ready, valid signal이 계속 켜져 있는 상태였기 때문에 FPGA board에서도 ready, valid signal이 계속 켜져있을 것이라고 가정하시는 경우가 있으나, 실제로 그렇지 않을 수 있습니다. Conv layer 5,6와 같이 weight의 크기가 굉장히 큰 경우 중간에 tvalid signal이 꺼질 수 있으며 ready signal 또한 마찬가지입니다.</li><li>Testbench에서 data가 이상하게 들어오는 경우 AXI protocol 과 관련된 control signal을 0으로 적절하게 초기화 해주세요.</li><li>(12/10) nexys 보드를 사용하시는 분들께서는 GitHub 공지를 확인하시고 mig IP를 수정해주시기 바랍니다.</li></ol><h2 id="team-2-apb-모듈의-paddr-관련-질문입니다">[Team 2] APB 모듈의 PADDR 관련 질문입니다.</h2><p>안녕하세요, Team 2 김형준입니다.</p><p><code class="inline-code-span">apb</code> 모듈 작성에서 <code class="inline-code-span">{PADDR[31:2],2&apos;h0}</code> 케이스에 따라 <code class="inline-code-span">prdata_reg</code>에 값을 넣어주어야 하는데 여기서 <code class="inline-code-span">PADDR</code>이 정확히 어떤 주소값을 의미하며 어떤 <code class="inline-code-span">PADDR</code>이 있을때 <code class="inline-code-span">prdata_reg</code>에 어떤 값을 넣어야하는지 이해가 잘 안됩니다.</p><p>감사합니다.</p><hr/><p>test/utils/scale_uart.py에서 su_pool_control, su_fc_control, su_conv_control 함수와 apb 모듈을 비교하며 코드를 이해하면 쉽습니다.</p><p>su_pool_control 함수에서 paddr는 pool apb 모듈로 mapping되어 있습니다. 따라서 paddr+0x4의 address에 0x1의 data를 write하는 경우 pool apb 모듈에서 PADDR은 0x4, PWDATA는 0x1이 될 것입니다. 이 부분을 이해한 뒤 scale_uart에서 적절한 read, write signal을 apb module에 보내주고 apb 모듈은 이를 받아 control signal을 pool_module과 주고받는 코드를 구현해 주세요.</p><h2 id="team-25-tb-simulation-멈춤-현상-관련">[Team 25] tb simulation 멈춤 현상 관련</h2><p>안녕하세요.</p><p>conv 모듈을 다 짠 듯해 conv_tb를 simulation을 돌리려고 하는데 error가 발생하지 않았음에도 불구하고 시뮬레이션이 Starting simulation data flow analysis 상태에서 멈추는 현상이 일어났습니다. 아래 사진과 같은 상황에서 더 이상 진전이 되지 않습니다.</p><p>이 현상이 일어나는 원인이 무엇인지, 해결할 수 있는 방법은 무엇인지 알고 싶습니다. 감사합니다.</p><p>(사진에는 Run Simulation 메시지박스가 Executing Elaboration Step... 하고 멈춰 있음)</p><p>(또 다른 사진은 로그 창 찍어놨는데 Starting simulation data flow analysis... 하고 멈춰 있음)</p><hr/><p>원인이 다양하게 있을 수 있지만 보통 이런경우엔 infinite for loop에서 걸렸을 확률이 높습니다. for loop에 iteration number의 bit-width가 제대로 설정되어 있는지 먼저 확인해보세요.</p><hr/><p>같은 수강생인데, 제 경험상 일부 컴퓨터에서는 $finish 나 $stop을 사용한 경우 simulation이 저 상태로 정지하기도 했어요. 참고해보세요</p><h2 id="team-2-git의-vivado-auxiliary-파일-ignore-관련-문의드립니다">[Team 2] Git의 Vivado auxiliary 파일 ignore 관련 문의드립니다.</h2><p>나는 데탑/노트북으로 동시에 할 거여서 이 질문은 걍 패스함</p><p>니네도 gitignore 추가하지 마셈 ㅋㅋ</p><h2 id="team-12-conv-layer-input-size-관련">[team 12] conv layer input size 관련</h2><p>안녕하세요, 팀 12 홍지안입니다.</p><p>conv layer 에서 이미지 input을 고려할 때, 이미지 size가 32x32로 나와있는데, convolution을 구현할 때 이미지 size가 2의 승수 혹은 정방형이 아닌 1024x768 같은 경우도 고려를 해야하는지 궁금하여 질문 남깁니다.</p><p>감사합니다.</p><hr/><p>저희는 cifar 10 dataset만 사용하기 때문에 input image는 32x32x3으로 고정되어 있습니다.</p><h2 id="verilog-문법-관련-질문">verilog 문법 관련 질문</h2><pre class="fenced-code-block"><code><span class="code-fence-row"><span class="code-fence-code">reg [7:0] A [31:0][62:0];</span></span>
<span class="code-fence-row"><span class="code-fence-code">wire [7:0] B[63:0][255:0];</span></span>
</code></pre><p>와 같이 선언한 후 아래와 같은 기능을 구현하고자 코드를 작성했습니다.</p><pre class="fenced-code-block"><code><span class="code-fence-row"><span class="code-fence-code">A[31][62:0] &lt;= {B[63-32*row_cnt][255-32*col_cnt -: 32], {31{8&apos;b0}}};</span></span>
</code></pre><p>하지만</p><p><code class="inline-code-span">part-select of memory &apos;A&apos; is not allowed</code> 라는 에러 메세지가 나왔습니다. 혹시 비슷한 기능을 구현하는 다른 방법이 있는지 여쭤보고 싶습니다.... 너무 힘듭니다....ㅠ_ㅠ</p><hr/><p>Verilog에서 array에대해 range index로 접근하는 것은 올바른 구현이 아닙니다. 한번에 하나씩 접근해주세요.</p><p><a href="http://www.fpga.world/_altera/html/_sw/q2help/source/msgs/evrfx_veri_illegal_part_select_of_memory.htm">http://www.fpga.world/_altera/html/_sw/q2help/source/msgs/evrfx_veri_illegal_part_select_of_memory.htm</a></p><h2 id="team-30-data-receive-질문">[Team 30] data receive 질문</h2><p>안녕하세요 pool 모듈에서 VALID와 <code class="inline-code-span">S_AXIS_TREADY</code>가 켜지면 데이터를 바로 받아오도록 하였는데 그랬더니 정말 <code class="inline-code-span">S_AXIS_DATA</code>의 초기값인 0이 가장 첫번째 데이터로 들어와서 하나씩 밀려 들어오는 것을 확인하였습니다.</p><p>혹시 <code class="inline-code-span">S_AXIS_TREADY</code>가 켜진 뒤 한 사이클 뒤의 데이터를 받아오도록 코드를 작성하라는 의도이신가요?</p><p>어떻게 해결해야할지 잘 모르겠습니다..</p><hr/><p>댓글/답댓글이 길어서 쭉 나열함!</p><ul><li>네 한 사이클 뒤부터 데이터를 받아오면 될 것 같습니다.<ul><li>다시 확인해보니 한사이클 뒤에는 두번째 데이터부터 들어옵니다.. 첫번째 데이터가 초기값인 0으로 대체되는 것 같습니다...</li></ul></li><li>음... AXI stream interface의 모든 값을 정상적으로 초기화 해주세요. 이를테면 <code class="inline-code-span">S_AXIS_TREADY</code>등의 signal을 X가 아닌 1&apos;b0 로 초기화 해주세요. waveform에 보이는 <code class="inline-code-span">M_AXIS_TDATA</code>의 경우도 마찬가지 입니다. tb의 BRAM에서 값이 저렇게 이상하게 들어오는 것은 AXI interface의 초기값이 X등 올바르게 초기화 되어있지 않은 경우 주로 발생할 수 있습니다. 해보시고 다시 댓글 달아주세요.<ul><li>axi interface 들을 0으로 초기화하였습니다. 그런데도 tdata의 첫번째 값이 0으로 들어오는 것 같습니다...</li><li>혹시 <code class="inline-code-span">S_AXIS_TDATA</code>를 0으로 초기화하는 부분이 어떤 모듈에 있는지 알 수 있을까요? 답변 감사합니다!</li></ul></li><li>이거 제가 예전에 같은 문제 겪었고 질문했었는데요, <code class="inline-code-span">tb.v</code>에서 input을 sram에 넣어줄 때 첫 번째 data를 제대로 넣어주지 못하는 버그가 있습니다. <code class="inline-code-span">tb.v</code>에서 첫 32bit input을 sram에 넣을 때에만 한 cycle을 더 delay하도록 수정하시면 해결될거에요.<ul><li>답변 정말 감사합니다! 혹시 <code class="inline-code-span">m_axis_tdata</code>를 받을 때도 똑같은 delay를 넣으셨나요?<ul><li>앗 저는 첫 번째 data가 0으로 들어오고, 그 다음부터 두 번째 data는 제대로 들어왔었는데 지민님은 데이터가 밀려 들어온 거였네요,, 아마 그럼 다른 문제일 것 같습니다.. <code class="inline-code-span">m_axis_tdata</code>를 받는다는게 무슨 말씀이신지 잘 모르겠는데 저는 <code class="inline-code-span">tb.v</code>에서 sram에 data 넣는 부분에만 딜레이 추가했습니다.</li></ul></li></ul></li></ul><h2 id="team-31-board-세팅-관련-문의드립니다">[team 31] board 세팅 관련 문의드립니다.</h2><p>nexys 보드랑 관련된 거라 우리랑 큰 상관 없을 듯?</p><h2 id="team-14-init_calib_done">[Team 14] init_calib_done</h2><p>안녕하세요, Team 14입니다. 보드 테스트를 진행하고 있는데, 보드에는 <code class="inline-code-span">init_calib_done</code> 신호를 LED로 출력하도록 되어 있습니다. 그런데 이 신호가 처음에 FPGA 보드 bitstream 프로그래밍을 할 때는 켜져서 LED가 켜지는데, 그 다음에 reset을 하고 다시 시작하려고 하면 꺼져 있습니다. 혹시 뭔가 FPGA가 잘못된 동작을 하고 있다고 볼 수 있을까요?</p><p>아울러, <code class="inline-code-span">main.v</code>에서 rstn을 output으로 빼서 LED에 연결해주면 처음 programming 했을 때만 정상적으로 반응하고, 코드를 뺐다 다시 연결하면 버튼을 눌러주지 않아도 계속 0으로 내려가 있습니다. 이런 문제는 어떤 이유로 발생할 수 있을까요?</p><hr/><ol type="1"><li>FPGA programming done led는 programming이 끝난 후에 켜지며 계속 켜져 있는 것은 아닙니다.</li><li>JTAG cable을 뺄 시 power가 공급되지 않아 board가 shutdown 이 되어 다시 케이블을 연결하더라도 정상적으로 작동하지 않을 것 같습니다. 코드를 뺐다 다시 연결할 시 programming을 다시 해 주세요.</li></ol><h2 id="team-20-pool-module에서-s_axis_tready-시그널-질문">[team 20] pool module에서 S_AXIS_TREADY 시그널 질문</h2><p>pool 모듈을 구성하는 중 궁금한 사항이 생겨 질문 남깁니다.</p><ol type="1"><li>pool 모듈 안에 <code class="inline-code-span">S_AXIS_TREADY</code> 라는 아웃풋(wire)가 선언되어 있는데  <code class="inline-code-span">s_axis_tready</code> 라는 wire를 왜 연결해서 쓰는지 모르겠습니다. 그래서 <code class="inline-code-span">s_axis_tready</code>를 reg로 바꾸었는데, 그렇게 해도 될까요?</li><li>저희 조는 <code class="inline-code-span">s_axis_tready</code> 시그널을 계속 1로 켜놓은 상태에서 VDMA의 data를 한 사이클마다 4B씩 읽어와 내부 reg에 저장할 수 있다고 생각했습니다. 하지만 testbench를 돌려보니  <code class="inline-code-span">pool_input_32bits_2s.txt</code> 의 데이터의 홀수줄만 읽어오는 것을 확인했습니다.</li><li>그렇다면 <code class="inline-code-span">s_axis_tready</code>를 적절히 켜고 끄는 과정이 필요하다고 생각하는데 언제 켜고 꺼야 하는지 모르겠습니다..</li></ol><hr/><ol type="1"><li>모듈 내의 wiring, register 선언은 자유이며 편하신대로 수정해 사용하시면 됩니다. register로 선언하시는게 편하시면 그렇게 하시면 됩니다.</li><li>홀수줄만 받아오도록 세팅되어 있지 않습니다. 구현에서 코드가 잘못된 것으로 보이며 이 부분은 디버깅이 필요할 것으로 보입니다.</li><li>신호의 이름에서 알 수 있듯이 data를 받아와서 register에 저장할 준비가 된 상태에서 on 시켜주고 <code class="inline-code-span">s_axis_valid</code> 신호가 on됨과 함께 데이터가 들어오길 기다리면 됩니다. 만약 연산중이라 register에 write할 상태가 아니라면 off로 두시면 됩니다.</li></ol><h2 id="team-1-single-layer-test-관련-문의">[Team 1] single layer test 관련 문의</h2><p>pool layer를 보드에 올리려고 하던 중 막혀서 질문드립니다. <code class="inline-code-span">self.su_write_data(paddr + 0x00, 0x1)</code>을 하면 pool start signal을 보내는 거라고 이해했는데 모듈의 0x0번 위치의 데이터를 출력해보면 계속 0이 나와서 모듈이 실행되지 않는 것 같습니다. apb 파일도 수정하였는데 pool start signal이 제대로 전달되려면 어떻게 하면 좋을까요?</p><hr/><p><code class="inline-code-span">self.su_read_data(paddr+0x0)</code>를 수행하셨을 때 pool_start register의 값이 1로 set되지 않았다고 말씀하시는 것인가요? 보통 apb와 통신이 제대로 되지 않는 경우는 programming이 제대로 되지 않았거나 reset을 통해 초기화를 제대로 시키지 않은 경우가 많습니다. board가 확실히 초기화 되었는지 확인하고 apb 모듈과 정상적으로 통신이 되는지 테스트하는 코드를 넣어 확인해보시는 걸 추천드립니다.</p><h2 id="team-12-fc-layer-음수-처리">[team 12] fc layer 음수 처리</h2><p>안녕하세요, fc layer에서 relu 데이터 tb는 통과가 되지만 일반 데이터에 대한 tb는 통과되지 않아 질문 남깁니다.</p><p>디버깅을 해봤을 때 음수를 truncate 하는 과정에서 버림연산을 그냥 뒤 bit들을 없애버리는 방식으로 구현한 것이 문제라고 생각되는데, 실제 계산 결과와 tb expected results 모두 뒤 bit를 없앤 후 1을 더해줘야지 음수에 대해 버림 연산이 시행됨을 확인할 수 있습니다.</p><p>따라서 lab 7에서처럼 음수여도 그냥 뒤의 bit들을 없애버리는게 맞는건지, 아님 저희가 생각한대로 뒤의 bit들을 없앤 후 1을 더하는게 맞는건지 궁금합니다.</p><hr/><p>안녕하세요, 말씀해주신 부분이 맞습니다.</p><p><code class="inline-code-span">cifar_pytorch.ipynb</code>를 확인해보시면 마지막 FC3의 경우 relu를 수행하지 않습니다. 그리고 FC3에서 음수에 대해 quauntization을 수행할 때는 (overflow가 아닌 경우) 만약 truncate할 bit들 (버릴 bits)이 모두 1인 경우 fraction part에 1을 더해주세요. 양수에 대해선 normal quantization rule에 따라 구현해주시면 됩니다.</p><p>예를 들어, result가 26bit인 경우, 그리고 LSB 6bit을 버려야 할 경우 <code class="inline-code-span">result[5:0]</code>가 6&apos;b111111인 경우에 fraction part에 1을 더해주시면 됩니다.</p><p>주석에 오류가 조금 있었던 것 같네요.</p><p>FC3 layer에서는 추가로 max_index를 구현하셔야 합니다. pytorch의 label indexing은 0부터가 아니라 1부터 되어 있기 때문에 해당 부분을 신경써주시기 바랍니다.</p><h2 id="team-14-pool-보드-테스트-질문">[Team 14] pool 보드 테스트 질문</h2><p>안녕하세요 Team 14입니다. pool tb를 통과하고 나서 보드 테스트를 시작하였는데, python에서 <code class="inline-code-span">read_addr()</code>가 정의되지 않은 값을 계속 return하는 문제가 일어나고 있습니다.</p><p>우선 현재 상태는 pool single layer test를 진행 중이며, VDMA와 모듈 apb 레지스터를 이용하여 메모리에 값을 쓰는 것까지는 되는 것 같습니다. pool start 신호를 준 뒤에, <code class="inline-code-span">apb.v</code>에 약속되어 있는 메모리 주소(base, base+4 등등)를 python으로 읽고 있는데, 정의되지 않은 값들이 계속 return 됩니다. <code class="inline-code-span">pool_apb.v</code>의 case, if-else 문에서 default까지 봐도 정의되지 않은 값인데 python에서 이런 값을 읽어오는 경우는 어떻게 문제를 찾기 시작해야 될지 여쭤보고 싶습니다.</p><p>+</p><p>ex)</p><p><code class="inline-code-span">SU.su_read_data(paddr+0x0)</code> 을 불렀을 때 저희가 받은 코드의 미리 구현된 부분에 따르면 <code class="inline-code-span">pool_start(0 or 1)</code>이 나와야 하는데, 8388736 등의 garbage 값이 나오는 상황입니다.</p><p>저희가 구현한 부분 뿐만 아니라 사전에 구현되어있는 부분까지 제대로 동작하지 않아 어떻게 대처해야 할지 알기 어려우며, apb로 register read를 할 수 없어 debugging도 어려운 상황입니다.</p><p>출력이 pool_apb에서 절대 나올 수 없는 형식임을 생각해보면 interconnect에서 오작동이 일어나 read 함수가 pool_apb까지 닿지 못하는 상황인 듯 한데, interconnect에서 어떤 일이 일어나는지는 이번 프로젝트의 scope을 벗어나는 부분이라 생각하여 질문 드립니다. 혹시 이런 경우에는 어떤 오류가 원인이 될 수 있을지, 아니면 skeleton code에서 오류가 있는 것인지 여쭤볼 수 있을까요?</p><hr/><p>FPGA를 programming한 뒤에 reset을 누르시고 테스트하고 계신 것이 맞나요? apb module과 host가 통신하는 것이 잘 작동하지 않는다면 programming이나 초기화가 제대로 되지 않았을 가능성이 높을 것 같습니다.</p><h2 id="team-30-sram-port-관련-질문">[Team 30] sram port 관련 질문</h2><p>안녕하세요 fc모듈 안에 sram을 만들었는데 포트를 찾지 못하는 오류가 생겨 질문드립니다. 어떻게 해결할 수 있을까요?.......</p><hr/><p>fc module에서 사용하실 sram이 sram_32x131072가 필요하신게 맞나요? <code class="inline-code-span">top_simulation.v</code>에서 u_sram_32x131072 instance를 보면 알겠지만 해당 bram은 AXI interface를 가진 SRAM이며 FC 모듈에서 사용하라고 제공해드린 것이 아닙니다. block memory generator에서 사용하실 bram을 native interface로 새로 만드신 다음 instantiate해서 사용해 주세요.</p><h2 id="team-14-hw-test-synthesis-warning-문의">[Team 14] HW test synthesis warning 문의</h2><p>테스트벤치를 통과하여 하드웨어에 업로드를 해보려는데 hw_test 프로젝트 파일을 열었을 때 아래와 같이 axi_crossbar 관련 경고 메세지가 default로 발생합니다. 저희가 수정하는 부분이 아닌 것 같아 에러의 원인이 감이 안잡히는데 혹시 그 이유와 해결방법에 대해 알려주실 수 있을까요? 사용하는 비바도의 버전은 2021.1 입니다.</p><hr/><p>ip를 모두 맞게 세팅하셨으면 큰 문제는 없을 것 같습니다. 테스트 해보시고 문제가 있을시 다시 질문 남겨주세요.</p><h2 id="vdma-동작-관련-질문">VDMA 동작 관련 질문</h2><p>pool_module이 tb를 통과해서 board에 업로드해서 single layer test를 진행 중인데, pool_module이 data를 receive해야 할 때 vdma가 작동하지 않아 계속 python code의 무한 loop을 돌고 있는 상황입니다.</p><p>(s_axis_tvalid, s_axis_tdata등 모든 값이 0으로 들어옵니다.)</p><p>vdma의 status register(0x04, 0x34 주소)를 출력해보니 0번, 16번, 24번 bit가 1로 set 되어 있습니다. control register의 경우에는 4, 7, 16번 bit가 1로 set되어 있습니다. vdma engine이 initialize되자마자 MM2S, S2MM 모두 halt하는 상황인 것 같은데, 이를 어떻게 해결할 수 있을지 알고 싶습니다..</p><hr/><p>안녕하세요, 말씀해주신 status register의 경우 0번째 bit이 set되어 있기 때문에 VDMA channel이 halt되어 있는 것 같습니다. VDMA channel을 halt에서 run state로 만들어주기 위해서는 control register의 0번째 bit이 set되어야 하는데 수강생 분의 경우 그렇지 않은 것 같습니다.</p><p>혹시 <code class="inline-code-span">scale_uart.py</code>의 su_pool_control 함수에서 VDMA control register (주소 0x0, 0x30)의 값을 0x00010091로 맞게 세팅해주고 계신가요?</p><p>control register의 0번째 bit이 1로 맞게 write하고 있는지 출력해보면서 확인하면 좋을 것 같습니다.</p><p>VDMA의 status register, control register에 대해 자세하게 확인해보고 싶으시면 아래의 product guide의 chapter 2 를 참조해 주세요.</p><p><a href="https://www.xilinx.com/content/dam/xilinx/support/documents/ip_documentation/axi_vdma/v6_3/pg020_axi_vdma.pdf">https://www.xilinx.com/content/dam/xilinx/support/documents/ip_documentation/axi_vdma/v6_3/pg020_axi_vdma.pdf</a></p><hr/><p>안녕하세요. 답변 정말 감사합니다. su_pool_control 함수에서는 register를 0x00010091로 제대로 set해주는데, 그 후에 register를 읽어오면 값이 0x00010090으로 바뀌어 있습니다.. vdma register를 write하는 순서도 바꿔보고, apb와 vdma에 write하는 순서도 바꿔봤지만 같은 현상이 발생합니다.</p><p>vdma에 vsize, hsize, stride를 먼저 적어주고 control register를 마지막에 적으면 control register가 0x00010091로 남아있기는 하지만 여전히 vdma가 작동하지 않습니다. (s_axis_tvalid가 0으로 유지됩니다.)</p><p>vdma control register가 값이 혼자 바뀌는 이유가 뭔지 알 수 있을까요?</p><p>또 tb에서는 제 pool_module이 axi stream을 통해 vdma로부터 data를 잘 받아왔었는데, 그렇다면 지금 이 현상은 제 pool_module의 문제보다는 python code에 문제가 있는 거라고 봐도 되는지 궁금합니다.</p><hr/><p>VDMA를 stop -&gt; reset 한 뒤 다시 start를 해보는 건 어떨까요?</p><pre class="fenced-code-block"><code><span class="code-fence-row"><span class="code-fence-code"><span class="color-red">self</span><span class="color-white">.</span><span class="color-aqua">su_write_data</span><span class="color-white">(</span><span class="color-white">vaddr</span><span class="color-white">+</span><span class="color-gold">0x</span><span class="color-gold">30</span><span class="color-white">. </span><span class="color-gold">0x</span><span class="color-gold">00000000</span><span class="color-white">)</span> <span class="color-gray">#</span><span class="color-gray">stop
</span></span></span>
<span class="code-fence-row"><span class="code-fence-code"><span class="color-red">self</span><span class="color-white">.</span><span class="color-aqua">su_write_data</span><span class="color-white">(</span><span class="color-white">vaddr</span><span class="color-white">+</span><span class="color-gold">0x</span><span class="color-gold">30</span><span class="color-white">. </span><span class="color-gold">0x</span><span class="color-gold">00000004</span><span class="color-white">)</span> <span class="color-gray">#</span><span class="color-gray">reset
</span></span></span>
<span class="code-fence-row"><span class="code-fence-code"><span class="color-aqua">sleep</span><span class="color-white">(</span><span class="color-gold">1</span><span class="color-white">)</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-code"><span class="color-red">self</span><span class="color-white">.</span><span class="color-aqua">su_write_data</span><span class="color-white">(</span><span class="color-white">vaddr</span><span class="color-white">+</span><span class="color-gold">0x</span><span class="color-gold">30</span><span class="color-white">. </span><span class="color-gold">0x</span><span class="color-gold">00010091</span><span class="color-white">)</span> <span class="color-gray">#</span><span class="color-gray">start</span></span></span>
</code></pre><p>만약 위의 경우에 작동한다면 0x00에 대해서도 마찬가지로 코드를 변경해주셔야 할 것 같습니다.</p><p>12/02 수정: 추가로 보드 reset을 확실히 하셨는지 확인해보세요</p><hr/><p>안녕하세요. 답변 감사합니다.</p><p>보드를 사용 전에 reset한 후 VDMA control register를 말씀하신대로 아래와 같이 write해봤습니다.</p><pre class="fenced-code-block"><code><span class="code-fence-row"><span class="code-fence-code"><span class="color-red">self</span><span class="color-white">.</span><span class="color-aqua">su_write_data</span><span class="color-white">(</span><span class="color-white">vaddr</span> <span class="color-white">+</span> <span class="color-gold">0x</span><span class="color-gold">00</span><span class="color-white">,</span> <span class="color-gold">0x</span><span class="color-gold">00000000</span><span class="color-white">)</span> <span class="color-gray">#</span><span class="color-gray">stop
</span></span></span>
<span class="code-fence-row"><span class="code-fence-code"><span class="color-red">self</span><span class="color-white">.</span><span class="color-aqua">su_write_data</span><span class="color-white">(</span><span class="color-white">vaddr</span> <span class="color-white">+</span> <span class="color-gold">0x</span><span class="color-gold">00</span><span class="color-white">,</span> <span class="color-gold">0x</span><span class="color-gold">00000004</span><span class="color-white">)</span> <span class="color-gray">#</span><span class="color-gray">reset
</span></span></span>
<span class="code-fence-row"><span class="code-fence-code"><span class="color-white">time</span><span class="color-white">.</span><span class="color-aqua">sleep</span><span class="color-white">(</span><span class="color-gold">1</span><span class="color-white">)</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-code"><span class="color-red">self</span><span class="color-white">.</span><span class="color-aqua">su_write_data</span><span class="color-white">(</span><span class="color-white">vaddr</span> <span class="color-white">+</span> <span class="color-gold">0x</span><span class="color-gold">00</span><span class="color-white">,</span> <span class="color-gold">0x</span><span class="color-gold">00010091</span><span class="color-white">)</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-code"><span class="color-red">self</span><span class="color-white">.</span><span class="color-aqua">su_write_data</span><span class="color-white">(</span><span class="color-white">vaddr</span> <span class="color-white">+</span> <span class="color-gold">0x</span><span class="color-gold">5c</span><span class="color-white">,</span> <span class="color-white">F</span><span class="color-white">[</span><span class="color-white">&apos;</span><span class="color-green">BASE_ADDR</span><span class="color-white">&apos;</span><span class="color-white">]</span><span class="color-white">)</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-code"><span class="color-red">self</span><span class="color-white">.</span><span class="color-aqua">su_write_data</span><span class="color-white">(</span><span class="color-white">vaddr</span> <span class="color-white">+</span> <span class="color-gold">0x</span><span class="color-gold">58</span><span class="color-white">,</span> <span class="color-white">F</span><span class="color-white">[</span><span class="color-white">&apos;</span><span class="color-green">STRIDE_SIZE</span><span class="color-white">&apos;</span><span class="color-white">]</span><span class="color-white">)</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-code"><span class="color-red">self</span><span class="color-white">.</span><span class="color-aqua">su_write_data</span><span class="color-white">(</span><span class="color-white">vaddr</span> <span class="color-white">+</span> <span class="color-gold">0x</span><span class="color-gold">54</span><span class="color-white">,</span> <span class="color-white">F</span><span class="color-white">[</span><span class="color-white">&apos;</span><span class="color-green">HSIZE</span><span class="color-white">&apos;</span><span class="color-white">]</span><span class="color-white">)</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-code"><span class="color-red">self</span><span class="color-white">.</span><span class="color-aqua">su_write_data</span><span class="color-white">(</span><span class="color-white">vaddr</span> <span class="color-white">+</span> <span class="color-gold">0x</span><span class="color-gold">50</span><span class="color-white">,</span> <span class="color-white">F</span><span class="color-white">[</span><span class="color-white">&apos;</span><span class="color-green">VSIZE</span><span class="color-white">&apos;</span><span class="color-white">]</span><span class="color-white">)</span></span></span>
</code></pre><p>그러나 이전과 동일하게 VSIZE가 적히기 직전까지는 running 상태이다가 VSIZE까지 적힌 직후에 VDMA가 halt합니다..ㅠㅠ</p><p>가장 처음 control register에는 16번 bit인 IRQFrameCount를 1로 넣어주는데, halt 상태일 때 status register를 살펴보면 16번 bit인 IRQFrameCntSts(Interrupt Frame Count Status)가 1으로 set 되어 있는 것으로 보아 가장 처음 control register로 총 1개의 frame이 transfer되도록 설정해뒀는데, initialization이 끝나자마자 vdma가 한 개의 frame의 transfer이 끝나버렸다고 인식하고 status regi 내의 IRQFrameCntSts를 1 증가시키고 이 값이 IRQFrameCount와 동일하므로 halt해버리는 것으로 보입니다.</p><p>즉, 실제로는 data가 전송되지 않았는데 vdma는 data가 전송되었다고 인식해서 멈추는 것 같은데, 이 문제를 어떻게 해결할 수 있을까요.. (halt 상태일 때 status register 내에 다른 error bit은 set되지 않습니다.)</p><hr/><p>내부 pool module을 잘못 구현하신 것 같네요. <code class="inline-code-span">s_axis_tvalid</code>, <code class="inline-code-span">s_axis_tdata</code> 모두 0으로 출력된다고 말씀해주셨는데 해당 signal은 vdma transaction이 모두 끝난 뒤의 signal을 cpu가 읽어왔을 가능성이 높습니다. AXI protocol에 맞게 data를 받아 올바르게 저장하고 있는지 확인해 보세요.</p><h2 id="team-31-clk_counter-관련-문의">[team 31] clk_counter 관련 문의</h2><p>각 모듈과 함께 존재하는 clk_counter에 대해서 apb를 건드릴 때, clk_counter 부분은 건드리지 말라고 되어있던데 사실 사용하지 않아도될것 같아서 지우고자 하는데 꼭 사용해야만 할까요?</p><hr/><p>clock counter는 채점에 반영되기 때문에 건드리지 말아주세요. clock counter의 목적은 VDMA trasaction 부터 module의 computation이 끝날 때까지의 clock cycle을 counting하여 모듈의 computation latency가 얼마나 짧은지 체크하는 것입니다. 따라서 clk counter를 지우신다면 performance 부분에 대해 점수를 드리기 어렵습니다.</p><h2 id="fpga-clk-frequency-질문">FPGA CLK frequency 질문</h2><p>FPGA에 코드를 올려서 테스트를 할 때, 혹시 생성해주는 CLK frequency 주파수를 저희가 맘대로 정하는 것이 아니고 100MHZ로 고정시키는 것이 맞을까요?</p><hr/><p>네, 맞습니다. clock frequency는 100MHz로 고정입니다</p><h2 id="team-30-paddress-관련-문의">[Team 30] paddress 관련 문의</h2><p>안녕하세요 apb 수정 중 이해가 안가는 점이 생겨 질문을 드립니다.</p><p>올려주신 skeleton 코드를 보면 uart와 apb에서 0x04번에 저장하고 있는 데이터 값이 다른데 수정하라는 의도이신 건지 아니면 다른 의미가 있는지 궁금합니다.</p><hr/><p>skeleton code로 드린건 sample이지 정답이 아닙니다. 올바르게 동작할 수 있도록 적절하게 수정 / 추가 하시면 됩니다.</p><h2 id="team-18-pool-layer-input-data-순서">[Team 18] pool layer input data 순서</h2><p>각 input으로 들어오는 <code class="inline-code-span">S_AXIS_TDATA</code> 32bits, 4개의 데이터에서  max를 계산하는 것이 아닌 것 같아서 질문 드립니다.</p><p>pooling layer에서 input data가 들어오는 순서가 어떻게 되는지 궁금합니다. row 방향으로 32bits씩 들어오는 것인가요?</p><hr/><p>pool 구현 완료한 수강생인데 row col depth 순으로 들어와요!</p><hr/><p>네, 맞습니다. row-major로 4B씩 들어옵니다.</p><h2 id="team-8-bram-동작에-관해서-질문-있습니다">[TEAM 8] bram 동작에 관해서 질문 있습니다.</h2><p>bram한 block 단위로 구성되어 큰 용량이 필요할 경우 여러 블록을 합쳐 구성하는 것으로 알고 있습니다. 그렇다면 이때 bram에는 각 block마다 input/output port가 있어서 혹시 개별적으로 동시에 입출력을 할 수 있나요? 이를 이용해 하나의 큰 bram을 선언하는 것이 아니라 작은 크기의 bram 여러 개를 설정해 동시에 매우 큰 bit의 output이 나올 수 있는지 궁금합니다.</p><p>그리고 fpga에서 bram은 무조건 블록 단위로만 설정되나요? bram의 크기는 18Kbit 또는 36Kbit인 것으로 구글링 결과에 나오는데 이때 예를 들어 6Kbit의 bram을 여러개 선언했을 때 이 bram들은 모두 개별적인 블록에 할당되는 것인가요?</p><p>또한, bram 용량이 모자른 경우를 위하여 작게 설정된 여러 블록들이 실제 합성에서 하나로 합쳐질 수는 없는 것인가요?</p><hr/><p>Xillinx 7-series의 경우 말씀 하신대로 18Kb, 36Kb 두 종류의 block primitive가 존재하며, Arty-A7 100 board의 경우 2개의 18Kb block RAM이 하나의 36Kb block RAM을 구성한 것이 135개 존재하여 총 4860Kb의 데이터를 저장할 수 있습니다. 이러한 block RAM은 각각 독립적인 I/O port를 가져 개별적으로 입출력이 가능하며 Cascade되어 더 큰 block RAM을 이룰 수 있습니다. 실제로 bram IP를 선언할 때 FPGA의 bram이 어떻게 할당되는지는 실제로 synthesis/implementation을 해보면서 결과를 살펴보면 명확할 것 같습니다.</p><p>아래에 block RAM datasheet을 첨부하니 참고해보시는 것도 좋을 것 같습니다.</p><p><a href="https://docs.xilinx.com/v/u/en-US/ug473_7Series_Memory_Resources">https://docs.xilinx.com/v/u/en-US/ug473_7Series_Memory_Resources</a></p><h2 id="setup-time-violation-관련-질문">setup time violation 관련 질문</h2><p>pool_module이 tb를 통과해서 implementation을 돌려보니 setup time violation이 나서 이를 해결하려 하는데, 어떻게 해결해야 할지 방향을 잘 모르겠어 질문을 드립니다.</p><p>위의 사진에서 보이는 것처럼 interface_top의 rstn_int2 reg의 output이 pool의 clk_counter의 몇 개의 register의 CLR pin으로 들어오기까지의 path에서 setup time violation이 발생하고 있습니다.</p><p>그 사이의 path에는 schematic 상의 LUT 외에는 별다른 comb logic이 없는 상황입니다. (해당 LUT는 verilog code에서는 보이지 않습니다..)</p><p>코드를 살펴봐도 그냥 port를 타고 신호가 전달될 뿐이지 그 사이에 별다른 로직이 없어서 어떻게 이 violation을 해결해야 할지 잘 모르겠습니다. clk_counter_reg와 interface_top 둘 다 건드린 적이 없습니다.</p><p>직전에 같은 reg를 source로 하는 violation이 제가 pool_module에 생성한 reg들을 dest로 해서 발생했었는데, 해당 reg들은 따로 reset이 필요하지 않아 그 reg들을 reset하는 logic을 빼주었더니 해결되기는 했습니다.</p><hr/><p>스크린샷을 보니 rstn 시그널관련된 부분인 것 같네요. 아마 현재 시스템 구조상 하나의 reset signal이 엄청나게 많은 FF에 들어가기때문에 skew로 인하여 clk/reset관련 negative slack이 나타날 수 있습니다. vivado timing analysis는 pessimistic하게 계산하기 때문에 작은 negative slack이라면 실제로는 violation이 꼭 일어나지는 않을 수도 있어요. <strong>clk/reset관련해서</strong> 1-2ns 정도의 negative slack은 저희가 구현한 코드에서도 나오는 것 같으니 일단 bistream을 만들어서 single layer test를 해보도록 하세요.</p><h2 id="team-30-비바도-sram-버전-문제">[team 30] 비바도 sram 버전 문제</h2><p>안녕하세요  IP upgrade를 했는데도 sram에서 s_axi_awid를 찾을 수없다는 오류가 떠서 질문드립니다. 검색을 해보았더니 비바도 버전 문제라고 나오는데 어떻게 해결을 해야할 지 모르겠습니다...</p><hr/><p>sram을 AXI4 -&gt; AXI4 (AXI4-Lite X)로 제대로 선언했나요?</p><h2 id="team-11-tb-ip할당-문제">[team 11] tb ip할당 문제</h2><p>tb를 돌려보기 위해 주어진 axi_interconnect_0.xci 파일과 axi_vdma_0.xci 파일을 add design sources를 통해 추가해주었습니다.</p><p>elaborate.log를 보면 사진과 같은 오류로 진행하지 못하고 있는데 ip파일 추가하는 방법이 제가 한 방법이 맞는지, 아니라면 혹시 어떻게 해결할 수 있는지 조언 부탁드립니다.</p><hr/><p>안녕하세요. 저도 수강생이지만 같은 문제를 겪었어서 댓글을 답니다. 저는 각 ip module을 우클릭해서 upgrade해주니 문제가 해결됐습니다.</p><h2 id="team-2-conv-모듈의-conv_start-신호에-대해-질문드립니다">[Team 2] conv 모듈의 conv_start 신호에 대해 질문드립니다.</h2><p>안녕하세요, Team 2 김형준입니다. conv 모듈의 <code class="inline-code-span">conv_start</code> 신호의 의미에 대해 질문 있습니다.</p><p>현재 <code class="inline-code-span">conv_apb</code> 모듈에서 <code class="inline-code-span">conv_start</code>의 값은 아래와 같이 지정됩니다:</p><p>이는 <code class="inline-code-span">conv_start</code>값이 한 번 1로 바뀌면, PRESETB (= rstn) 신호를 통해 시스템 전체에 대한 초기화가 이루어지지 않을 경우 (즉, 시스템이 동작하는 전체 시간동안) 1로 유지됨을 알 수 있습니다. 이것이 시스템 작동 시작 후 각 conv 모듈이 처음 동작하는 순간부터 끊임없이 작동하게끔 의도하신 것인지, 혹은 저희가 임의로 작동 원리를 변경해 사용해도 괜찮을지 궁금합니다.</p><p>또한 시스템 작동 시작 후 각 conv 모듈이 처음 동작하는 순간부터 끊임없이 작동하게끔 의도하셨을 경우, conv 모듈이 하나의 입력값을 받고 계산을 진행한 후 출력이 끝나면 곧바로 다음 입력값을 받도록 설계하면 될 지에 대해서도 여쭙고 싶습니다.</p><hr/><p><code class="inline-code-span">scale_uart.py</code>에 있는 su_conv_control function의 동작을 보시면 될 것 같네요. 끊임없이 작동한다는게 무슨 의미인지는 모르겠으나, conv_start signal이 assert 되면 한 convolution layer를 끝내기 전까지는 멈추거나 다른 layer의 연산을 시작하지 않음을 가정합니다.</p><h2 id="team-14-conv-layer에서의-input-저장-문의">[Team 14] conv layer에서의 input 저장 문의</h2><p>안녕하세요, Team 14입니다. conv. layer에서 메모리로부터 input 데이터를 받게 되는데, 이 때 conv. 모듈 내에서 input을 한꺼번에 저장하기 위해 최대 input 크기만큼 reg로 선언해놓고 데이터를 받는 방식으로 구현해도 되는지 궁금합니다. 예를 들어, conv 2 layer의 input size는 32&#42;16&#42;16&#42;8 = 2&#94;16인데, 이 크기를 가지는 reg를 모듈 내에 선언하여 구현해도 되는 것인가요?</p><hr/><p>저희가 정해둔 reg 선언의 제한은 따로 없습니다. 다만 FPGA의 hardware resource constraint와 timing constraint를 잘 고려해서 사용하시면 됩니다.</p><h2 id="team-15-tb에서-data-receive-관련-문의">[Team 15] tb에서 data receive 관련 문의</h2><p>pool module의 test bench를 실행하다 질문이 생겨 글을 올립니다. simulation을 돌려보니 아래와 같이 memory와 pooling module이 동작하고 있습니다.</p><ol type="1"><li>시뮬레이션이 시작하는 순간부터 pool module로 들어오는 <code class="inline-code-span">S_AXIS_TDATA</code>는 0으로 initialize되어 있습니다.</li><li>pooling module이 <code class="inline-code-span">S_AXIS_TREADY</code>를 1로 set하면, 다음 cycle부터 input data의 두 번째 line에 해당하는 data부터 차례대로 data들이 넘어옵니다.</li></ol><p>위와 같은 동작 때문에 input data의 첫 번째 line에 해당해야 할 <code class="inline-code-span">S_AXIS_TDATA</code>의 값이 32&apos;b0으로 고정되어 있어 input의 첫 line을 제대로 받아오지 못하고 있습니다.</p><p><code class="inline-code-span">tb.v</code>의 주석에서 feature의 base addr가 0000_0000이면 첫 번째 data가 안 넘어올 수 있다고 하셔서 이 addr의 문제인 것 같아 다른 주소들도 시도해봤지만 여전히 첫 번째 data가 넘어오지 않아 질문을 드립니다.</p><hr/><p>혹시 <code class="inline-code-span">S_AXIS_TREADY</code>가 처음에 X로 되어있으면 0으로 초기화를 시켜보세요.</p><h2 id="team-1-layer_tb-메모리-write-관련-문의">[Team 1] layer_tb 메모리 write 관련 문의</h2><p><code class="inline-code-span">tb/pool/tb.v</code> 의 153~192 line에서 block memory에 데이터를 쓰는데, 시뮬레이션을 돌려보니</p><blockquote>[VRFC 10-2991] &apos;blk_mem_gen_v8_4_4_inst&apos; is not declared under prefix &apos;axi_mem_module&apos; [&quot;C:/Users/ECE/Downloads/2022_dsd_final_project-team1-arty/2022_dsd_final_project-team1-arty/src/tb/pool/tb.v&quot;:155] </blockquote><p>라는 에러가 발생하여 실제로 generated 된 bram을 살펴보았습니다.</p><p>다음과 같이 blk_mem_gen_v8_4_5로 이름이 달라서 위와 같은 에러가 발생한 것 같아 tb.v의 코드 중 blk_mem_gen_v8_4_4_inst를 모두 blk_mem_gen_v8_4_5로 바꾸었는데도</p><blockquote>[VRFC 10-2991] &apos;blk_mem_gen_v8_4_5&apos; is not declared under prefix &apos;axi_mem_module&apos; [&quot;C:/Users/ECE/Downloads/2022_dsd_final_project-team1-arty/2022_dsd_final_project-team1-arty/src/tb/pool/tb.v&quot;:155] </blockquote><p>라고 에러가 발생했습니다. 이런 에러를 어떻게 해결하면 좋을지 질문드립니다.</p><hr/><p>같은 수강생인데, 아마 뒤에 inst 안쓰셔서 그런거 같아요..!</p><h2 id="team-15-tb-project-내-sram-문의">[Team 15] tb project 내 sram 문의</h2><p>/build/layer_tb 내의 tb project들에서 다른 ip들은 제공해주신 것과 달리 sram_32x131072은 존재하지 않아 시뮬레이션을 실행할 수가 없습니다. 이 module은 직접 이전 lab에서 배운 것처럼 instantiate하면 되는 것인지 알고 싶습니다. 또 만약 그렇다면 이전에 배운 대로 생성했을 때의 sram과 다르게 tb project 내의 sram들은 AXI4-Full 관련 port들을 갖는 것으로 보아 다른 방식으로 sram을 생성해야 할 것 같은데 그 방법을 알고 싶습니다.</p><hr/><p>네 직접 만들어서 사용해야 합니다. 32x131072 (Read/Write Width: 32, Depth: 131072) BRAM IP 를 sram_32x131072 라는 이름으로 만들면 되요. Interface Type을 Native-&gt;AXI4 로 바꾸어 주세요. </p><h2 id="team-6-module-내의-sram-문의">[Team 6] module 내의 SRAM 문의</h2><p>이전 답변을 보니 내부에서 사용할 SRAM을 만들 때 이전 lab에서 사용한 IP를 그대로 사용해도 된다고 하셨는데, 이번 lab에서 연산에 사용하려 부르는 data는 그 크기가 훨씬 커서, 기존의  32*16 bit size 가지고는 부족할 것 같습니다. 혹시 SRAM을 만들 때 memory의 depth를 마음대로 조정해도 괜찮나요? 아니면 기존 크기의 memory를 여러 개 사용해야 하나요?</p><hr/><p>네 bram을 사용하셔도 되며 디자인에 필요한 형태로 설정하시면 됩니다.</p><h2 id="team-5-사용하는-8bit-data-format">[Team 5] 사용하는 8bit data format</h2><p>8bit , 2&apos;s complement를 사용한다고 들었는데, radix point의 위치에 따라 마지막에 overflow, underflow detect 및 truncation logic이 달라질 것으로 예상됩니다.</p><p>INT8(8bit 모두 정수부로서 사용)로 quantize된 dataset에 대해 연산 시키는 하드웨어를 만들면 될까요? 혹은 radix point가 어디에 있는 dataset인가요?</p><hr/><p>INT8 2&apos;s compl fixed point 이며 sign, integer bit이 각각 1-bit fract가 6-bit입니다.</p><hr/><p>추가로, 최종 연산 결과(result)에 대해 실습 시간에 수행하신 대로 8bit으로 quantization을 진행하셔야 합니다.</p><h2 id="team-14-weight-데이터의-순서-문의">[Team 14] weight 데이터의 순서 문의</h2><p>각 연산 모듈에 대하여 weight이 어떤 순서로 주어지는지 궁금합니다. 예를 들어, fc 모듈에서 feature가 1&#42;m, weight이 m&#42;n, bias가 1&#42;n의 차원을 가질 때, weight 데이터가 (tb의 경우, txt 파일에 들어있는 weight 데이터) row 순서(n-size row 가 차례로 m개)로 들어오는지, column(m-size column이 차례로 n개) 순서로 들어오는지 궁금합니다.</p><hr/><p>weight은 계산하기 가장 편한 순서로 들어오게 됩니다. MV multiplication 인 FC의 경우에는 weight이 column-major로 들어오고, Conv의 경우에는 이와 다르게 row -&gt; column -&gt; channel (filter) 순으로 weight이 들어오게 됩니다.</p><h2 id="team-31-변수-관련-문의">[Team 31] 변수 관련 문의</h2><ol type="1"><li> Convolutional layer 부분에서 사용되는 SRAM을 어떤 식으로 정의하나요? Lab 시간에는 FC layer를 만들 때 IP catalog를 이용했는데, 같은 방식으로 진행하나요?</li><li>파일을 보니 input data가 2&apos;s complement 형식을 사용하는 것 같은데, 맞을까요?  Lab 시간에 signed magnitude를 사용했던 기억이 있어 확실하게 하고자 여쭤봅니다.</li><li>AXI-Stream protocol에서 TKEEP과 TUSER의 역할이 뭔가요? 프로젝트 설명 시간에 TKEEP을 건드리지 말라는 설명을 들은 기억이 있고 document에도 비슷한 내용이 있던데, TKEEP의 사용 방식을 읽어보니 값이 0가 되는 index에 해당하는 데이터(ex : 1110이면 첫 데이터)를 사용하지 않는다고 써 있었습니다. 그래서 pooling에서 maximum인 값을 선별할 때 사용한다고 이해하였는데, &quot;TKEEP을 건드리지 말라는&quot; 설명과 상충하는 것 같아 질문드립니다.</li><li>각 layer module에서, pool_start가 1인 경우에 operation이 실행된다고 설명이 되어 있었습니다. 파이프라이닝으로 모듈을 구현 중인데, 만약 중간에 pool_start가 0가 되면 실행 중이던 작업도 전부 중지가 되는지, 아니면 기존 진행 중이던 작업은 계속 진행되고 새로 들어올 작업만 중지되는지 궁금합니다.</li><li>apb 파일들에서 저희가 해야 할 task를 혹시 더 구체적으로 알 수 있을까요? 주어진 코드에서 이미 idle-&gt;setup-&gt;access의 과정은 전부 구현되어 있고, 이해하기로는 read data와 write data 역시 모두 구현되어 있는 것 같습니다. Reference로 주어진 APB Protocol에는 있지만 코드에는 없는 내용인 PREADY등을 추가하는 것인지, 아니면 구현에 불완전한 부분이 있어서(transfer 여부 등에서) 보충해야 하는 지 정확히 모르겠습니다.</li></ol><hr/><ol type="1"><li>Lab에서 사용했던 것과 동일하게 선언하시면 됩니다.</li><li>이번 프로젝트에서는 2&apos;s compl을 data format으로 사용합니다.</li><li>TKEEP과 TUSER는 각각 4&apos;b1111, 1&apos;b0로 고정되어 있으며 이 부분은 이번 프로젝트 구현과 연관이 없습니다 (pool과도 연관이 없습니다). 따라서 그대로 두시면 됩니다.</li><li>scale_uart.py 의 su_*_control 에 방식 그대로 동작하고 그 상황을 기준으로 채점할 예정이니 다른 예외 경우는 고려하지 않으셔도 됩니다.</li><li>APB는 scale_uart.py 의 su_*_control과 main compute module 사이에서 주고받는 signal 들을 해석(?)해주는 interface의 역할을 합니다. scale_uart.py 코드를 잘 읽어보시면 될 것 같습니다.</li></ol><hr/><p>4번 질문에서 pool_start signal은 scale_uart.py의 line 389의 self.su_write_data(paddr + 0x00, 0x1) #start가 실행되면서 register에 값이 적히게 되는데, 이때 pool_apb에서 이 register 값을 읽고 pool_start signal을 생성해주는 것입니다. register에는 한번 write되었으니 다시 값을 overwrite하지 않는 이상(self.su_write_data(paddr + 0x00, 0x0) # Reset module)은 register 값이 바뀌지 않겠지만, pool_start 값은 pool_apb가 어떻게 signal을 생성하는지에 따라 결정됩니다.</p><h2 id="team-14-tb-fbw_writedone-관련-질문입니다">[Team 14] TB (F,B,W)_writedone 관련 질문입니다.</h2><p>안녕하세요, module 별 TB 관련 질문이 있어 글을 올립니다. <code class="inline-code-span">FC module tb.v</code>에 보면 다음과 같은 코드가 있습니다.</p><pre class="fenced-code-block"><code><span class="code-fence-row"><span class="code-fence-code">$display(&quot;FC starts to read feature&quot;);</span></span>
<span class="code-fence-row"><span class="code-fence-code"></span></span>
<span class="code-fence-row"><span class="code-fence-code">wait(F_writedone);</span></span>
<span class="code-fence-row"><span class="code-fence-code"></span></span>
<span class="code-fence-row"><span class="code-fence-code">$display(&quot;FC finishes to read feature\n&quot;);</span></span>
<span class="code-fence-row"><span class="code-fence-code"></span></span>
<span class="code-fence-row"><span class="code-fence-code">...</span></span>
<span class="code-fence-row"><span class="code-fence-code"></span></span>
<span class="code-fence-row"><span class="code-fence-code">top_simulation u_top_simulation</span></span>
<span class="code-fence-row"><span class="code-fence-code"></span></span>
<span class="code-fence-row"><span class="code-fence-code">(.clk(clk),</span></span>
<span class="code-fence-row"><span class="code-fence-code"></span></span>
<span class="code-fence-row"><span class="code-fence-code">...</span></span>
<span class="code-fence-row"><span class="code-fence-code"></span></span>
<span class="code-fence-row"><span class="code-fence-code">...</span></span>
<span class="code-fence-row"><span class="code-fence-code"></span></span>
<span class="code-fence-row"><span class="code-fence-code">.F_writedone(F_writedone),</span></span>
<span class="code-fence-row"><span class="code-fence-code"></span></span>
<span class="code-fence-row"><span class="code-fence-code">...</span></span>
</code></pre><p>다만, <code class="inline-code-span">top_simulation.v</code>를 들어가보면 정작 F_writedone에 대한 assignment가 없습니다. 이때문에 testbench에서 feature load 이상으로 넘어가지 않아 bias, weight load, 그리고 연산에 대한 실험을 진행하기 어려운 상황입니다. 이는 테스트벤치에서 필요한 코드가 빠져있는 것인가요, 아니면 저희가 tb에서 직접 구현해야 할 부분인가요?</p><hr/><p>F_writedone은 fc_module의 output으로써 먼저 fc_module에서 구현해주시고 이후 tb에서도 fc_module의 F_writedone output을 추가해주셔야 합니다. F_writedone은 fc_module이 feature data를 잘 받아왔다는 신호인데, 이거를 fc_module에서 먼저 작성해주셔야 합니다. 혹은 fc_module에서 다른 이름으로 정의하여 output을 추가하셨다면 이름을 맞춰주셔야 합니다.</p><hr/><p>말씀하신 대로 구현에 따라 필요한 control signal은 달라질 수 있기 때문에 현재 나누어 드린 tb와 top_simulation code는 <strong>완전하지 않습니다</strong>. 코드를 이해하는 것은 어렵지 않으니 찬찬히 살펴보시고 원하시는 control signal을 추가해 수정을 하신 뒤에 simulation을 진행하셔야 합니다. 즉, testbench는 여러분의 디자인에 맞춰 수정하여 사용하셔야 합니다.</p><h2 id="team-14-vivado-version-관련-질문드립니다">[Team 14] Vivado version 관련 질문드립니다.</h2><p>안녕하세요, 프로젝트 진행에 있어서 비바도 버전 관련 궁금증이 있어 질문드립니다. 207호 컴퓨터를 이용해 프로젝트를 열어보려 했더니, 비바도의 버전이 다르기 때문에 IP를 전부 강제적으로 업그레이드하거나, read-only로 열어야 한다는 표시가 떴습니다. 제공된 IP를 바꾸는 것은 올바르지 않은 것 같고, 학교 컴퓨터의 비바도 버전을 함부로 바꿀 수 없어서 어떻게 해야 할지 고민입니다. 프로젝트에 포함된 IP 버전을 임의로 바꾸면 안되고 vivado 2021 기준으로 진행해야 한다고 생각하면 될까요?</p><p>+) 프로젝트를 다시 열어보니 2020년 vivado 기준으로 만들어져 2021년도 vivado로도 열리지 않습니다. 랩 세션을 처음 시작할 때 vivado 2021 을 기준으로 안내받았는데, vivado를 downgrade 해야 할까요?</p><hr/><p>IP upgrade 해서 사용하시면 됩니다. IP port는 바뀐 부분이 없기 때문에 문제 없을겁니다.</p>
        <a id="bottom"></a>
    </article>





    <script src="colors.js"></script>

    
    <script src="nav.js"></script>
    
</body>

</html>